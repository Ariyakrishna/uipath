{
    "schemaVersion": "1.0.0",
    "imports":
    [
        "js/aw-command-panel.directive",
        "js/aw-command-panel-section.directive",
        "js/aw-panel-footer.directive",
        "js/aw-add.directive",
        "js/aw-xrt.directive",
        "js/aw-form.directive",
        "js/enable-when.directive",
        "js/visible-when.directive",
        "js/aw-button.directive",
        "js/aw-i18n.directive"
    ],
    "data": {
        "triggerCreate": {
            "dbValue": false,
            "type": "BOOLEAN"
        },
        "addPanelState": {
            "initialValues": {
                "creationType": "",
                "createdObject": "",
                "sourceObjects": "",
                "selectedTab": ""
            },
            "meta": {}
        },
        "activeState": {
            "initialValues": {
                "activeView": "Mtw0ShowAddObjectRelation",
                "context": {}
            },
            "meta": {}
        },
        "xrtState": {
            "initialValues": {},
            "meta": {
                "xrtVMO": {
                    "field": "true",
                    "type": "viewModelObject"
                }
            }
        },
        "projectState": {
            "initialValues": {
                "selectedProjects": [],
                "triggerAssign": false
            },
            "meta": {
                "selectedProjects": {
                    "field": "true",
                    "type": "OBJECT"
                },
                "triggerAssign": {
                    "field": "true",
                    "type": "BOOLEAN"
                }
            }
        }
    },
    "editHandlers": {
        "addPanelEditHandler": {
            "context": "CREATE_PANEL_CONTEXT",
            "dataSource": {
                "xrtVMO": "{{data.xrtState}}"
            }
        }
    },
    "actions":
    {
       "initiateRelateOperation":
        {
            "actionType": "TcSoaService",
            "serviceName": "Core-2008-06-DataManagement",
            "method": "createObjects",
            "inputData":
            {
                "input": "{{function:getInputForRelationSOA}}"
            },

            "outputData":
            {
                "createdObjectUid": "output[0].objects[0].uid",
                "createdObject": "output[0].objects[0]"
            },

            "actionMessages":
            {
                "failure":
                [
                    {
                        "message": "SOAFailureMsg"
                    }
                ]
            },

            "events":
            {
                "failure":
                [
                    {
                        "name": "complete",
                        "eventData":
                        {
                            "source": "toolAndInfoPanel"
                        }
                    }
                ],
                "success":
                [

                    {
                        "name": "cdm.relatedModified",
                        "eventData":
                        {
                            "relatedModified":
                            [
                                "{{ctx.selected}}"
                            ],

                            "refreshLocationFlag": true
                        }
                    },

                    {
                        "name": "complete",
                        "eventData":
                        {
                            "source": "toolAndInfoPanel"
                        }
                    }
                ]
            },

            "deps": "js/Mtw0ShowAddObjectService"
        },
     "closePanel":
        {
            "actionType": "Event",
            "method": "Event",
            "inputData":
            {
                "events":
                [
                    {
                        "name": "complete",
                        "eventData":
                        {
                            "source": "toolAndInfoPanel"
                        }
                    }
                ]
            }
        }
    },

    "messages": {
        "SOAFailureMsg": {
            "messageType": "ERROR",
            "messageText": "{{errorCode}}"
        }
    },

    "functions":
    {
        "getInputForRelationSOA":
        {
            "functionName": "getInputForRelationSOA",
            "parameters":
            [
                "{{data}}",
                "{{ctx}}",
                "{{editHandlers.addPanelEditHandler}}"
            ]
        }
    },
    "onEvent":
    [

        {
            "eventId": "gwt.SubLocationContentSelectionChangeEvent",
            "action": "closePanel"
        }
    ],

    "i18n":
    {
        "addButtonTitle": ["MaterialMgmtMessages"],
        "addLabel": ["MaterialMgmtMessages"],
        "addPropertiesLabel":["MaterialMgmtMessages"]
    },

    "ctx": {
        "sub-panel-context": {
            "type": "object"
        },
        "selected":{
            "type": "object"
        },
        "secondaryObjForXrtCreate":{
            "type": "string"
        },
        "relation":{
            "type": "string"
        },
        "searchFilter":{
            "type": "string"
        },
        "relationPrimaryObj":{
            "type": "object"
        },
        "relationSecondaryObj":{
            "type": "object"
        }
    }
}
